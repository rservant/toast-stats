swagger: '2.0'
info:
  title: Toast Stats API Gateway
  description: |
    API Gateway for Toast-Stats - Toastmasters District Statistics and Analytics.
    
    This gateway routes requests to the Cloud Run backend with explicit endpoint
    definitions for parameter validation and documentation.
  version: '2.0.0'

schemes:
  - https

basePath: /api

host: toast-stats-18majkbqxtagv.apigateway.toast-stats-prod-6d64a.cloud.goog

# CORS configuration
x-google-endpoints:
  - name: toast-stats-18majkbqxtagv.apigateway.toast-stats-prod-6d64a.cloud.goog
    allowCors: true

# Security definition (not required for operations)
securityDefinitions:
  api_key:
    type: apiKey
    name: key
    in: query

paths:
  # ============================================================================
  # HEALTH CHECK ENDPOINT
  # ============================================================================

  /health:
    get:
      summary: Health check endpoint
      operationId: healthCheck
      tags:
        - Health
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app/health
        path_translation: CONSTANT_ADDRESS
      produces:
        - application/json
      responses:
        '200':
          description: Service is healthy
        '503':
          description: Service unavailable

  # ============================================================================
  # DISTRICT ENDPOINTS
  # ============================================================================

  /districts:
    get:
      summary: List all districts
      operationId: getDistricts
      tags:
        - Districts
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      responses:
        '200':
          description: Successfully retrieved list of districts
        '404':
          description: No data available
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /districts/rankings:
    get:
      summary: Get global district rankings
      operationId: getDistrictRankings
      tags:
        - Rankings
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: date
          in: query
          type: string
          format: date
          description: Date for rankings snapshot (YYYY-MM-DD format)
          required: false
        - name: fallback
          in: query
          type: boolean
          description: Whether to fall back to nearest available snapshot
          required: false
          default: true
      responses:
        '200':
          description: Successfully retrieved district rankings
        '400':
          description: Bad request - invalid date format
        '404':
          description: No data available for requested date
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /districts/cache/dates:
    get:
      summary: Get all cached dates across all districts
      operationId: getAllCachedDates
      tags:
        - Cache
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      responses:
        '200':
          description: Successfully retrieved cached dates
        '404':
          description: No cached data available
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /districts/{districtId}/statistics:
    get:
      summary: Get district statistics
      operationId: getDistrictStatistics
      tags:
        - Districts
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: districtId
          in: path
          type: string
          required: true
          description: District identifier (e.g., "57", "F")
        - name: date
          in: query
          type: string
          format: date
          description: Date for statistics snapshot (YYYY-MM-DD format)
          required: false
      responses:
        '200':
          description: Successfully retrieved district statistics
        '400':
          description: Bad request - invalid district ID or date format
        '404':
          description: District or snapshot not found
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /districts/{districtId}/clubs:
    get:
      summary: Get clubs in a district
      operationId: getDistrictClubs
      tags:
        - Districts
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: districtId
          in: path
          type: string
          required: true
          description: District identifier (e.g., "57", "F")
      responses:
        '200':
          description: Successfully retrieved clubs for the district
        '400':
          description: Bad request - invalid district ID
        '404':
          description: District not found or no data available
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /districts/{districtId}/membership-history:
    get:
      summary: Get district membership history
      operationId: getDistrictMembershipHistory
      tags:
        - Districts
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: districtId
          in: path
          type: string
          required: true
          description: District identifier (e.g., "57", "F")
        - name: months
          in: query
          type: integer
          minimum: 1
          maximum: 24
          default: 6
          description: Number of months of history to retrieve
          required: false
      responses:
        '200':
          description: Successfully retrieved membership history
        '400':
          description: Bad request - invalid district ID or months parameter
        '404':
          description: District not found or no data available
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /districts/{districtId}/educational-awards:
    get:
      summary: Get district educational awards
      operationId: getDistrictEducationalAwards
      tags:
        - Districts
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: districtId
          in: path
          type: string
          required: true
          description: District identifier (e.g., "57", "F")
        - name: months
          in: query
          type: integer
          minimum: 1
          maximum: 24
          default: 6
          description: Number of months of history to retrieve
          required: false
      responses:
        '200':
          description: Successfully retrieved educational awards
        '400':
          description: Bad request - invalid district ID or months parameter
        '404':
          description: District not found or no data available
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /districts/{districtId}/daily-reports:
    get:
      summary: Get district daily reports
      operationId: getDistrictDailyReports
      tags:
        - Districts
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: districtId
          in: path
          type: string
          required: true
          description: District identifier (e.g., "57", "F")
        - name: startDate
          in: query
          type: string
          format: date
          required: true
          description: Start date for report range (YYYY-MM-DD format)
        - name: endDate
          in: query
          type: string
          format: date
          required: true
          description: End date for report range (YYYY-MM-DD format)
      responses:
        '200':
          description: Successfully retrieved daily reports
        '400':
          description: Bad request - invalid parameters or date range
        '404':
          description: District not found or no data available
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /districts/{districtId}/daily-reports/{date}:
    get:
      summary: Get district daily report for specific date
      operationId: getDistrictDailyReportByDate
      tags:
        - Districts
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: districtId
          in: path
          type: string
          required: true
          description: District identifier (e.g., "57", "F")
        - name: date
          in: path
          type: string
          format: date
          required: true
          description: Report date (YYYY-MM-DD format)
      responses:
        '200':
          description: Successfully retrieved daily report
        '400':
          description: Bad request - invalid district ID or date format
        '404':
          description: District or report not found
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /districts/{districtId}/rank-history:
    get:
      summary: Get district rank history
      operationId: getDistrictRankHistory
      tags:
        - Rankings
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: districtId
          in: path
          type: string
          required: true
          description: District identifier (e.g., "57", "F")
        - name: startDate
          in: query
          type: string
          format: date
          description: Start date for history range (YYYY-MM-DD format)
          required: false
        - name: endDate
          in: query
          type: string
          format: date
          description: End date for history range (YYYY-MM-DD format)
          required: false
      responses:
        '200':
          description: Successfully retrieved rank history
        '400':
          description: Bad request - invalid parameters
        '404':
          description: District not found or no data available
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /districts/{districtId}/available-ranking-years:
    get:
      summary: Get available ranking years for district
      operationId: getDistrictAvailableRankingYears
      tags:
        - Rankings
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: districtId
          in: path
          type: string
          required: true
          description: District identifier (e.g., "57", "F")
      responses:
        '200':
          description: Successfully retrieved available ranking years
        '400':
          description: Bad request - invalid district ID
        '404':
          description: District not found or no data available
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /districts/{districtId}/cached-dates:
    get:
      summary: Get cached dates for district
      operationId: getDistrictCachedDates
      tags:
        - Cache
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: districtId
          in: path
          type: string
          required: true
          description: District identifier (e.g., "57", "F")
      responses:
        '200':
          description: Successfully retrieved cached dates
        '400':
          description: Bad request - invalid district ID
        '404':
          description: District not found or no cached data
        '500':
          description: Internal server error
        '503':
          description: Service unavailable


  # ============================================================================
  # ANALYTICS ENDPOINTS
  # ============================================================================

  /districts/{districtId}/analytics:
    get:
      summary: Get district analytics
      description: |
        Returns pre-computed analytics for the specified district.
        
        **Pre-computed Analytics Required**: This endpoint serves pre-computed
        analytics files generated by the scraper-cli. If analytics have not been
        generated for the requested district and date, a 404 error is returned.
        
        Use the scraper-cli `compute-analytics` command to generate pre-computed
        analytics for snapshots that are missing them.
      operationId: getDistrictAnalytics
      tags:
        - Analytics
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: districtId
          in: path
          type: string
          required: true
          description: District identifier (e.g., "57", "F")
        - name: startDate
          in: query
          type: string
          format: date
          description: Start date for analytics range (YYYY-MM-DD format)
          required: false
        - name: endDate
          in: query
          type: string
          format: date
          description: End date for analytics range (YYYY-MM-DD format)
          required: false
      responses:
        '200':
          description: |
            Successfully retrieved pre-computed district analytics.
            
            Response includes:
            - Core analytics data (membership, clubs, educational awards, etc.)
            - performanceTargets: Per-metric rankings (world rank, percentile, region rank)
            - paymentsTrend: Array of payment trend data points (date, payments) from membership analytics
            
            Note: paymentsTrend is optional and only included when membership analytics are available.
        '400':
          description: Bad request - invalid district ID or date format
        '404':
          description: |
            Pre-computed analytics not available. This error is returned when:
            - No pre-computed analytics exist for the requested district and date
            - The snapshot directory exists but analytics have not been generated
            - The requested endDate snapshot does not exist (SNAPSHOT_NOT_FOUND)
            
            Use the scraper-cli `compute-analytics` command to generate analytics.
        '500':
          description: |
            Internal server error. This error is returned when:
            - The pre-computed analytics file is corrupted or contains invalid JSON
            - The analytics schema version is incompatible with the current backend version
            
            For schema version mismatch, regenerate analytics using the latest scraper-cli.
        '503':
          description: Service unavailable

  /districts/{districtId}/membership-analytics:
    get:
      summary: Get district membership analytics
      description: |
        Returns pre-computed membership analytics for the specified district.
        
        **Pre-computed Analytics Required**: This endpoint serves pre-computed
        analytics files generated by the scraper-cli. If analytics have not been
        generated for the requested district, a 404 error is returned.
        
        Use the scraper-cli `compute-analytics` command to generate pre-computed
        analytics for snapshots that are missing them.
      operationId: getDistrictMembershipAnalytics
      tags:
        - Analytics
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: districtId
          in: path
          type: string
          required: true
          description: District identifier (e.g., "57", "F")
        - name: startDate
          in: query
          type: string
          format: date
          description: Start date for analytics range (YYYY-MM-DD format)
          required: false
        - name: endDate
          in: query
          type: string
          format: date
          description: End date for analytics range (YYYY-MM-DD format)
          required: false
      responses:
        '200':
          description: Successfully retrieved pre-computed membership analytics
        '400':
          description: Bad request - invalid parameters
        '404':
          description: |
            Pre-computed membership analytics not found. This error is returned when:
            - No pre-computed analytics exist for the requested district
            - The snapshot directory exists but membership analytics have not been generated
            - The requested endDate snapshot does not exist (SNAPSHOT_NOT_FOUND)
            
            Run scraper-cli `compute-analytics` to generate membership analytics.
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /districts/{districtId}/clubs/{clubId}/trends:
    get:
      summary: Get club trends
      description: |
        Returns pre-computed trend data for a specific club within a district.
        
        **Pre-computed Analytics Required**: This endpoint serves pre-computed
        club trends from the club-trends-index file generated by scraper-cli.
        If the club trends index has not been generated, a 404 error is returned.
        
        Use the scraper-cli `compute-analytics` command to generate pre-computed
        analytics including club trends for snapshots that are missing them.
      operationId: getClubTrends
      tags:
        - Analytics
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: districtId
          in: path
          type: string
          required: true
          description: District identifier (e.g., "57", "F")
        - name: clubId
          in: path
          type: string
          required: true
          description: Club identifier
      responses:
        '200':
          description: Successfully retrieved pre-computed club trends
        '400':
          description: Bad request - invalid district ID or club ID
        '404':
          description: |
            Pre-computed club trends not found. This error is returned when:
            - No pre-computed club trends index exists for the requested district
            - The club ID is not found in the pre-computed club trends index
            
            Run scraper-cli `compute-analytics` to generate club trends data.
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /districts/{districtId}/vulnerable-clubs:
    get:
      summary: Get vulnerable clubs in district
      description: |
        Returns pre-computed list of vulnerable clubs requiring attention.
        
        **Pre-computed Analytics Required**: This endpoint serves pre-computed
        vulnerable clubs data generated by the scraper-cli. If the vulnerable
        clubs file has not been generated, a 404 error is returned.
        
        Use the scraper-cli `compute-analytics` command to generate pre-computed
        analytics including vulnerable clubs for snapshots that are missing them.
      operationId: getVulnerableClubs
      tags:
        - Analytics
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: districtId
          in: path
          type: string
          required: true
          description: District identifier (e.g., "57", "F")
        - name: endDate
          in: query
          type: string
          required: false
          description: |
            End date for analytics data in YYYY-MM-DD format.
            When provided, returns vulnerable clubs data from the snapshot for that specific date.
            When omitted, returns data from the latest available snapshot.
      responses:
        '200':
          description: Successfully retrieved pre-computed vulnerable clubs list
        '400':
          description: Bad request - invalid district ID
        '404':
          description: |
            Pre-computed vulnerable clubs data not found. This error is returned when:
            - No pre-computed vulnerable clubs file exists for the requested district
            - The snapshot directory exists but vulnerable clubs have not been generated
            - The requested endDate snapshot does not exist (SNAPSHOT_NOT_FOUND)
            
            Run scraper-cli `compute-analytics` to generate vulnerable clubs data.
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /districts/{districtId}/leadership-insights:
    get:
      summary: Get leadership insights for district
      description: |
        Returns pre-computed leadership insights and effectiveness metrics.
        
        **Pre-computed Analytics Required**: This endpoint serves pre-computed
        leadership insights generated by the scraper-cli. If leadership insights
        have not been generated, a 404 error is returned.
        
        Use the scraper-cli `compute-analytics` command to generate pre-computed
        analytics including leadership insights for snapshots that are missing them.
      operationId: getLeadershipInsights
      tags:
        - Analytics
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: districtId
          in: path
          type: string
          required: true
          description: District identifier (e.g., "57", "F")
        - name: startDate
          in: query
          type: string
          format: date
          description: Start date for insights range (YYYY-MM-DD format)
          required: false
        - name: endDate
          in: query
          type: string
          format: date
          description: End date for insights range (YYYY-MM-DD format)
          required: false
      responses:
        '200':
          description: Successfully retrieved pre-computed leadership insights
        '400':
          description: Bad request - invalid parameters
        '404':
          description: |
            Pre-computed leadership insights not found. This error is returned when:
            - No pre-computed leadership insights file exists for the requested district
            - The snapshot directory exists but leadership insights have not been generated
            - The requested endDate snapshot does not exist (SNAPSHOT_NOT_FOUND)
            
            Run scraper-cli `compute-analytics` to generate leadership insights.
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /districts/{districtId}/distinguished-club-analytics:
    get:
      summary: Get distinguished club analytics
      description: |
        Returns pre-computed distinguished club analytics including progress
        tracking, projections, and detailed club data.
        
        **Pre-computed Analytics Required**: This endpoint serves pre-computed
        distinguished club analytics generated by the scraper-cli. If the analytics
        have not been generated, a 404 error is returned.
        
        Use the scraper-cli `compute-analytics` command to generate pre-computed
        analytics including distinguished club data for snapshots that are missing them.
      operationId: getDistinguishedClubAnalytics
      tags:
        - Analytics
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: districtId
          in: path
          type: string
          required: true
          description: District identifier (e.g., "57", "F")
        - name: startDate
          in: query
          type: string
          format: date
          description: Start date for analytics range (YYYY-MM-DD format)
          required: false
        - name: endDate
          in: query
          type: string
          format: date
          description: End date for analytics range (YYYY-MM-DD format)
          required: false
      responses:
        '200':
          description: Successfully retrieved pre-computed distinguished club analytics
        '400':
          description: Bad request - invalid parameters
        '404':
          description: |
            Pre-computed distinguished club analytics not found. This error is returned when:
            - No pre-computed distinguished club analytics file exists for the requested district
            - The snapshot directory exists but distinguished club analytics have not been generated
            - The requested endDate snapshot does not exist (SNAPSHOT_NOT_FOUND)
            
            Run scraper-cli `compute-analytics` to generate distinguished club analytics.
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /districts/{districtId}/analytics-summary:
    get:
      summary: Get aggregated analytics summary
      description: |
        Returns combined analytics data including summary metrics, trend data,
        and year-over-year comparisons in a single request.
        
        **Pre-computed Analytics Required**: This endpoint requires pre-computed
        analytics to be available. If analytics have not been generated for the
        requested district, a 404 error with code ANALYTICS_NOT_AVAILABLE is returned.
        
        Use the unified backfill service with job type 'analytics-generation' to
        generate pre-computed analytics for snapshots that are missing them.
        
        Response times are typically under 2 seconds when pre-computed analytics exist.
      operationId: getDistrictAnalyticsSummary
      tags:
        - Analytics
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: districtId
          in: path
          type: string
          required: true
          description: District identifier (e.g., "57", "F")
        - name: startDate
          in: query
          type: string
          format: date
          description: Start date for analytics range (YYYY-MM-DD format)
          required: false
        - name: endDate
          in: query
          type: string
          format: date
          description: End date for analytics range (YYYY-MM-DD format)
          required: false
      responses:
        '200':
          description: Successfully retrieved aggregated analytics summary
          schema:
            type: object
            properties:
              districtId:
                type: string
                description: District identifier
              dateRange:
                type: object
                properties:
                  start:
                    type: string
                    format: date
                    description: Start date of the analytics range
                  end:
                    type: string
                    format: date
                    description: End date of the analytics range
              summary:
                type: object
                properties:
                  totalMembership:
                    type: integer
                    description: Total membership count for the district
                  membershipChange:
                    type: integer
                    description: Change in membership payments between current and baseline (payment-based)
                  memberCountChange:
                    type: integer
                    description: Change in actual member count between current and baseline snapshot
                  clubCounts:
                    type: object
                    properties:
                      total:
                        type: integer
                        description: Total number of clubs
                      thriving:
                        type: integer
                        description: Number of thriving clubs
                      vulnerable:
                        type: integer
                        description: Number of vulnerable clubs
                      interventionRequired:
                        type: integer
                        description: Number of clubs requiring intervention
                  distinguishedClubs:
                    type: object
                    properties:
                      smedley:
                        type: integer
                        description: Number of Smedley Distinguished clubs
                      presidents:
                        type: integer
                        description: Number of Presidents Distinguished clubs
                      select:
                        type: integer
                        description: Number of Select Distinguished clubs
                      distinguished:
                        type: integer
                        description: Number of Distinguished clubs
                      total:
                        type: integer
                        description: Total number of distinguished clubs
                  distinguishedProjection:
                    type: number
                    description: Projected number of distinguished clubs
              trends:
                type: object
                properties:
                  membership:
                    type: array
                    items:
                      type: object
                      properties:
                        date:
                          type: string
                          format: date
                        count:
                          type: integer
                  payments:
                    type: array
                    items:
                      type: object
                      properties:
                        date:
                          type: string
                          format: date
                        payments:
                          type: integer
              yearOverYear:
                type: object
                properties:
                  membershipChange:
                    type: number
                    description: Year-over-year membership change
                  distinguishedChange:
                    type: number
                    description: Year-over-year distinguished clubs change
                  clubHealthChange:
                    type: number
                    description: Year-over-year club health change
        '400':
          description: Bad request - invalid parameters
        '404':
          description: |
            Pre-computed analytics not available. Returns error with code
            ANALYTICS_NOT_AVAILABLE when pre-computed analytics have not been
            generated for the requested district. Use the unified backfill
            service with job type 'analytics-generation' to generate analytics.
            
            Error response schema:
            - error.code: "ANALYTICS_NOT_AVAILABLE"
            - error.message: Description of the issue
            - error.details.districtId: The requested district ID
            - error.details.recommendation: How to resolve the issue
            - error.details.backfillJobType: "analytics-generation"
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /districts/{districtId}/year-over-year/{date}:
    get:
      summary: Get year-over-year comparison
      description: |
        Returns pre-computed year-over-year comparison metrics between current
        and previous program year.
        
        **Pre-computed Analytics Required**: This endpoint serves pre-computed
        year-over-year comparison data generated by the scraper-cli. If the
        comparison data has not been generated, a 404 error is returned.
        
        Use the scraper-cli `compute-analytics` command to generate pre-computed
        analytics including year-over-year comparisons for snapshots that are missing them.
      operationId: getYearOverYearComparison
      tags:
        - Analytics
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: districtId
          in: path
          type: string
          required: true
          description: District identifier (e.g., "57", "F")
        - name: date
          in: path
          type: string
          format: date
          required: true
          description: Comparison date (YYYY-MM-DD format)
      responses:
        '200':
          description: Successfully retrieved pre-computed year-over-year comparison
        '400':
          description: Bad request - invalid district ID or date format
        '404':
          description: |
            Pre-computed year-over-year data not found. This error is returned when:
            - No pre-computed year-over-year file exists for the requested district
            - Insufficient historical data exists for year-over-year comparison
            
            Run scraper-cli `compute-analytics` to generate year-over-year data.
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /districts/{districtId}/export:
    get:
      summary: Export district data
      operationId: exportDistrictData
      tags:
        - Districts
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
        - text/csv
      parameters:
        - name: districtId
          in: path
          type: string
          required: true
          description: District identifier (e.g., "57", "F")
        - name: format
          in: query
          type: string
          enum:
            - json
            - csv
          default: json
          description: Export format
          required: false
        - name: startDate
          in: query
          type: string
          format: date
          description: Start date for export range (YYYY-MM-DD format)
          required: false
        - name: endDate
          in: query
          type: string
          format: date
          description: End date for export range (YYYY-MM-DD format)
          required: false
      responses:
        '200':
          description: Successfully exported district data
        '400':
          description: Bad request - invalid parameters
        '404':
          description: District not found or no data available
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  # ============================================================================
  # ADMIN ENDPOINTS
  # ============================================================================

  /admin/health:
    get:
      summary: Get system health metrics
      description: |
        Returns aggregated system health metrics including cache hit rates,
        average response times, pending operations count, snapshot store status,
        and pre-computed analytics coverage.
      operationId: getSystemHealth
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      responses:
        '200':
          description: Successfully retrieved system health metrics
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /admin/snapshots:
    get:
      summary: List snapshots with analytics availability
      description: |
        List all snapshots with optional filtering and limiting.
        Each snapshot includes an analytics_available field indicating
        whether pre-computed analytics (analytics-summary.json) exist.
        Response metadata includes counts of snapshots with and without analytics.
      operationId: listSnapshots
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: limit
          in: query
          type: integer
          minimum: 1
          maximum: 100
          default: 20
          description: Maximum number of snapshots to return
          required: false
        - name: status
          in: query
          type: string
          enum:
            - success
            - failed
            - partial
          description: Filter by snapshot status
          required: false
        - name: schema_version
          in: query
          type: string
          description: Filter by schema version
          required: false
        - name: calculation_version
          in: query
          type: string
          description: Filter by calculation version
          required: false
        - name: created_after
          in: query
          type: string
          format: date-time
          description: Filter snapshots created after this timestamp
          required: false
        - name: created_before
          in: query
          type: string
          format: date-time
          description: Filter snapshots created before this timestamp
          required: false
        - name: min_district_count
          in: query
          type: integer
          minimum: 1
          description: Filter by minimum district count
          required: false
      responses:
        '200':
          description: Successfully retrieved snapshots list with analytics availability
          schema:
            type: object
            properties:
              snapshots:
                type: array
                items:
                  type: object
                  properties:
                    snapshot_id:
                      type: string
                      description: Unique identifier for the snapshot
                    created_at:
                      type: string
                      format: date-time
                      description: ISO timestamp when snapshot was created
                    status:
                      type: string
                      enum:
                        - success
                        - failed
                        - partial
                      description: Snapshot creation status
                    schema_version:
                      type: string
                      description: Version of the data structure schema
                    calculation_version:
                      type: string
                      description: Version of the calculation/scoring logic
                    size_bytes:
                      type: integer
                      description: Approximate size of the snapshot in bytes
                    error_count:
                      type: integer
                      description: Number of errors recorded in this snapshot
                    district_count:
                      type: integer
                      description: Number of districts included in this snapshot
                    analytics_available:
                      type: boolean
                      description: Whether pre-computed analytics exist for this snapshot
              metadata:
                type: object
                properties:
                  total_count:
                    type: integer
                    description: Total number of snapshots returned
                  analytics_available_count:
                    type: integer
                    description: Number of snapshots with pre-computed analytics
                  analytics_missing_count:
                    type: integer
                    description: Number of snapshots without pre-computed analytics
                  filters_applied:
                    type: object
                    description: Filters that were applied to the query
                  limit_applied:
                    type: integer
                    description: Limit that was applied to the query (null if none)
                  query_duration_ms:
                    type: integer
                    description: Query execution time in milliseconds
                  generated_at:
                    type: string
                    format: date-time
                    description: ISO timestamp when response was generated
        '400':
          description: Bad request - invalid query parameters
        '500':
          description: Internal server error
        '503':
          description: Service unavailable
    delete:
      summary: Delete snapshots by IDs
      description: |
        Delete multiple snapshots by their IDs. Implements cascading deletion
        including snapshot data files, pre-computed analytics, and time-series
        index entries.
      operationId: deleteSnapshots
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              snapshotIds:
                type: array
                items:
                  type: string
                description: Array of snapshot IDs to delete
            required:
              - snapshotIds
      responses:
        '200':
          description: Successfully deleted snapshots
        '400':
          description: Bad request - invalid snapshot IDs
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /admin/snapshots/range:
    delete:
      summary: Delete snapshots in date range
      description: |
        Delete all snapshots within a specified date range (inclusive).
        Implements cascading deletion including snapshot data files,
        pre-computed analytics, and time-series index entries.
      operationId: deleteSnapshotsInRange
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              startDate:
                type: string
                format: date
                description: Start date (inclusive, YYYY-MM-DD format)
              endDate:
                type: string
                format: date
                description: End date (inclusive, YYYY-MM-DD format)
            required:
              - startDate
              - endDate
      responses:
        '200':
          description: Successfully deleted snapshots in range
        '400':
          description: Bad request - invalid date range
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /admin/snapshots/all:
    delete:
      summary: Delete all snapshots
      description: |
        Delete all snapshots, optionally filtered by district ID.
        Implements cascading deletion including snapshot data files,
        pre-computed analytics, and time-series index entries.
      operationId: deleteAllSnapshots
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: body
          in: body
          required: false
          schema:
            type: object
            properties:
              districtId:
                type: string
                description: If provided, only delete data for this district
      responses:
        '200':
          description: Successfully deleted all snapshots
        '400':
          description: Bad request - invalid district ID
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /admin/snapshots/{snapshotId}:
    get:
      summary: Get snapshot details
      operationId: getSnapshotDetails
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: snapshotId
          in: path
          type: string
          required: true
          description: Unique identifier for the snapshot
      responses:
        '200':
          description: Successfully retrieved snapshot details
        '400':
          description: Bad request - invalid snapshot ID
        '404':
          description: Snapshot not found
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /admin/snapshots/{snapshotId}/payload:
    get:
      summary: Get snapshot payload
      operationId: getSnapshotPayload
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: snapshotId
          in: path
          type: string
          required: true
          description: Unique identifier for the snapshot
      responses:
        '200':
          description: Successfully retrieved snapshot payload
        '400':
          description: Bad request - invalid snapshot ID
        '404':
          description: Snapshot not found
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  # ============================================================================
  # ADMIN DISTRICT CONFIGURATION ENDPOINTS
  # ============================================================================

  /admin/districts/config:
    get:
      summary: Get district configuration
      operationId: getDistrictConfig
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      responses:
        '200':
          description: Successfully retrieved district configuration
        '500':
          description: Internal server error
        '503':
          description: Service unavailable
    post:
      summary: Add or replace districts in configuration
      operationId: updateDistrictConfig
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              districtIds:
                type: array
                items:
                  type: string
                description: Array of district IDs to add or set
              replace:
                type: boolean
                default: false
                description: If true, replace entire configuration; if false, add to existing
            required:
              - districtIds
      responses:
        '200':
          description: Successfully updated district configuration
        '400':
          description: Bad request - invalid district IDs
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /admin/districts/config/{districtId}:
    delete:
      summary: Remove a district from configuration
      operationId: removeDistrictFromConfig
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: districtId
          in: path
          type: string
          required: true
          description: District identifier to remove
      responses:
        '200':
          description: Successfully removed district from configuration
        '400':
          description: Bad request - invalid district ID
        '404':
          description: District not found in configuration
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /admin/districts/config/validate:
    post:
      summary: Validate district configuration
      operationId: validateDistrictConfig
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: body
          in: body
          required: false
          schema:
            type: object
            properties:
              allDistrictIds:
                type: array
                items:
                  type: string
                description: Optional list of all valid district IDs to validate against
      responses:
        '200':
          description: Successfully validated district configuration
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /admin/districts/config/history:
    get:
      summary: Get district configuration change history
      operationId: getDistrictConfigHistory
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: limit
          in: query
          type: integer
          minimum: 1
          maximum: 100
          default: 50
          description: Maximum number of history entries to return
          required: false
        - name: start_date
          in: query
          type: string
          format: date
          description: Filter history entries after this date
          required: false
        - name: end_date
          in: query
          type: string
          format: date
          description: Filter history entries before this date
          required: false
        - name: include_summary
          in: query
          type: boolean
          default: false
          description: Include summary statistics in response
          required: false
      responses:
        '200':
          description: Successfully retrieved configuration history
        '400':
          description: Bad request - invalid query parameters
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  # ============================================================================
  # ADMIN BACKFILL ENDPOINTS (Pre-computed Analytics)
  # ============================================================================

  /admin/backfill:
    post:
      summary: Trigger backfill of pre-computed analytics
      description: |
        Triggers a backfill operation to generate pre-computed analytics for
        existing snapshots. Can be filtered by date range and district IDs.
      operationId: triggerAdminBackfill
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: body
          in: body
          required: false
          schema:
            type: object
            properties:
              startDate:
                type: string
                format: date
                description: Start date for backfill range (YYYY-MM-DD)
              endDate:
                type: string
                format: date
                description: End date for backfill range (YYYY-MM-DD)
              districtIds:
                type: array
                items:
                  type: string
                description: Array of district IDs to backfill (optional, defaults to all)
      responses:
        '202':
          description: Backfill job accepted and started
        '400':
          description: Bad request - invalid parameters
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /admin/backfill/{jobId}:
    get:
      summary: Get backfill job progress
      description: |
        Returns the current progress of a backfill job including percentage
        complete, current snapshot being processed, and any errors.
      operationId: getAdminBackfillProgress
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: jobId
          in: path
          type: string
          required: true
          description: Unique identifier for the backfill job
      responses:
        '200':
          description: Successfully retrieved backfill progress
        '404':
          description: Backfill job not found
        '500':
          description: Internal server error
        '503':
          description: Service unavailable
    delete:
      summary: Cancel a backfill job
      description: |
        Cancels a running or pending backfill job. Jobs that are already
        completed or cancelled cannot be cancelled again.
      operationId: cancelAdminBackfill
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: jobId
          in: path
          type: string
          required: true
          description: Unique identifier for the backfill job
      responses:
        '200':
          description: Backfill job cancelled successfully
        '400':
          description: Bad request - job cannot be cancelled (already completed or cancelled)
        '404':
          description: Backfill job not found
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  # ============================================================================
  # UNIFIED BACKFILL SERVICE ENDPOINTS
  # ============================================================================
  # These endpoints provide a consolidated backfill service with persistent job
  # state, automatic recovery, and support for both data collection and analytics
  # generation operations.

  /admin/unified-backfill:
    post:
      summary: Create a new unified backfill job
      description: |
        Creates a new backfill job for either data collection (historical snapshots)
        or analytics generation (pre-computed analytics). Only one job can run at a time.
        Jobs are persisted and can be recovered after server restart.
      operationId: createUnifiedBackfillJob
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              jobType:
                type: string
                enum:
                  - data-collection
                  - analytics-generation
                description: Type of backfill operation
              startDate:
                type: string
                format: date
                description: Start date for backfill range (YYYY-MM-DD, required for data-collection)
              endDate:
                type: string
                format: date
                description: End date for backfill range (YYYY-MM-DD, required for data-collection)
              targetDistricts:
                type: array
                items:
                  type: string
                description: Array of district IDs to process (optional, defaults to configured districts)
              skipExisting:
                type: boolean
                default: true
                description: Skip dates that already have snapshots (for data-collection)
              rateLimitOverrides:
                type: object
                properties:
                  maxRequestsPerMinute:
                    type: integer
                    minimum: 1
                    maximum: 1000
                  maxConcurrent:
                    type: integer
                    minimum: 1
                    maximum: 100
                  minDelayMs:
                    type: integer
                    minimum: 0
                    maximum: 60000
                  maxDelayMs:
                    type: integer
                    minimum: 0
                    maximum: 300000
                  backoffMultiplier:
                    type: number
                    minimum: 1
                    maximum: 10
                description: Optional rate limit configuration overrides
            required:
              - jobType
      responses:
        '202':
          description: Backfill job created and queued for processing
        '400':
          description: Bad request - invalid parameters or date range
        '409':
          description: Conflict - another backfill job is already running
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /admin/unified-backfill/jobs:
    get:
      summary: List backfill job history
      description: |
        Returns a paginated list of backfill jobs with optional filtering by
        status and job type. Jobs are sorted by creation time (newest first).
      operationId: listUnifiedBackfillJobs
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: limit
          in: query
          type: integer
          minimum: 1
          maximum: 100
          default: 20
          description: Maximum number of jobs to return
          required: false
        - name: offset
          in: query
          type: integer
          minimum: 0
          default: 0
          description: Number of jobs to skip for pagination
          required: false
        - name: status
          in: query
          type: string
          description: Comma-separated list of statuses to filter by (pending, running, completed, failed, cancelled, recovering)
          required: false
        - name: jobType
          in: query
          type: string
          description: Comma-separated list of job types to filter by (data-collection, analytics-generation)
          required: false
      responses:
        '200':
          description: Successfully retrieved job list
        '400':
          description: Bad request - invalid query parameters
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /admin/unified-backfill/preview:
    post:
      summary: Preview a backfill job (dry run)
      description: |
        Returns a preview of what a backfill job would process without actually
        creating or executing the job. Useful for estimating duration and scope.
      operationId: previewUnifiedBackfillJob
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              jobType:
                type: string
                enum:
                  - data-collection
                  - analytics-generation
                description: Type of backfill operation
              startDate:
                type: string
                format: date
                description: Start date for backfill range (YYYY-MM-DD)
              endDate:
                type: string
                format: date
                description: End date for backfill range (YYYY-MM-DD)
              targetDistricts:
                type: array
                items:
                  type: string
                description: Array of district IDs to process
              skipExisting:
                type: boolean
                default: true
                description: Skip dates that already have snapshots
            required:
              - jobType
      responses:
        '200':
          description: Successfully generated preview
        '400':
          description: Bad request - invalid parameters
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /admin/unified-backfill/config/rate-limit:
    get:
      summary: Get rate limit configuration
      description: |
        Returns the current rate limit configuration for backfill operations.
      operationId: getUnifiedBackfillRateLimitConfig
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      responses:
        '200':
          description: Successfully retrieved rate limit configuration
        '500':
          description: Internal server error
        '503':
          description: Service unavailable
    put:
      summary: Update rate limit configuration
      description: |
        Updates the rate limit configuration for backfill operations.
        Only provided fields are updated; others retain their current values.
      operationId: updateUnifiedBackfillRateLimitConfig
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              maxRequestsPerMinute:
                type: integer
                minimum: 1
                maximum: 1000
                description: Maximum requests per minute
              maxConcurrent:
                type: integer
                minimum: 1
                maximum: 100
                description: Maximum concurrent operations
              minDelayMs:
                type: integer
                minimum: 0
                maximum: 60000
                description: Minimum delay between requests in milliseconds
              maxDelayMs:
                type: integer
                minimum: 0
                maximum: 300000
                description: Maximum delay between requests in milliseconds
              backoffMultiplier:
                type: number
                minimum: 1
                maximum: 10
                description: Backoff multiplier for rate limiting
      responses:
        '200':
          description: Successfully updated rate limit configuration
        '400':
          description: Bad request - invalid configuration values
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /admin/unified-backfill/{jobId}:
    get:
      summary: Get unified backfill job status
      description: |
        Returns the current status and progress of a specific backfill job,
        including per-district progress details and any errors encountered.
      operationId: getUnifiedBackfillJobStatus
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: jobId
          in: path
          type: string
          required: true
          description: Unique identifier for the backfill job
      responses:
        '200':
          description: Successfully retrieved job status
        '404':
          description: Backfill job not found
        '500':
          description: Internal server error
        '503':
          description: Service unavailable
    delete:
      summary: Cancel a unified backfill job
      description: |
        Cancels a running or pending backfill job. Jobs that are already
        completed, failed, or cancelled cannot be cancelled again.
      operationId: cancelUnifiedBackfillJob
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: jobId
          in: path
          type: string
          required: true
          description: Unique identifier for the backfill job
      responses:
        '200':
          description: Backfill job cancelled successfully
        '400':
          description: Bad request - job cannot be cancelled (already completed or cancelled)
        '404':
          description: Backfill job not found
        '500':
          description: Internal server error
        '503':
          description: Service unavailable

  /admin/unified-backfill/{jobId}/force-cancel:
    post:
      summary: Force-cancel a stuck backfill job
      description: |
        Force-cancels a backfill job that is stuck in 'running' or 'recovering' state.
        This is a destructive operation that marks the job as cancelled and clears
        its checkpoint to prevent automatic recovery.
        
        Requires explicit confirmation via the 'force' parameter.
      operationId: forceCancelBackfillJob
      tags:
        - Admin
      x-google-backend:
        address: https://toast-stats-api-736334703361.us-east1.run.app
        path_translation: APPEND_PATH_TO_ADDRESS
      produces:
        - application/json
      parameters:
        - name: jobId
          in: path
          type: string
          required: true
          description: Unique identifier for the backfill job
        - name: force
          in: query
          type: boolean
          required: false
          description: Must be true to confirm the force-cancel operation
      responses:
        '200':
          description: Job successfully force-cancelled
        '400':
          description: Bad request - force parameter missing or job in terminal state
        '404':
          description: Backfill job not found
        '500':
          description: Internal server error
        '503':
          description: Service unavailable
